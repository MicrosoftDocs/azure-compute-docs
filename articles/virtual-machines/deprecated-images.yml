### YamlMime:FAQ
metadata:
  title: Deprecated Azure Marketplace images
  description: "Learn about how the deprecation of Marketplace images can affect your deployment."
  author: cynthn
  ms.service: azure-virtual-machines
  ms.topic: faq
  ms.subservice: imaging
  ms.custom: devx-track-azurepowershell, devx-track-azurecli
  ms.date: 01/28/2026
  ms.author: cynthn
  ms.reviewer: edewe
  ai-usage: ai-assisted
title: Deprecated images FAQ
summary: |
  This article answers commonly asked questions about what happens when images in the Azure Marketplace are deprecated.

  ## Overview

  When an Azure Marketplace image is deprecated, its availability for new deployments changes—but existing virtual machines (VMs) and virtual machine scale set (VMSS) instances continue running normally. This article explains platform behavior during image deprecation, which operations are impacted, and what actions (if any) you must take.

  ## What image deprecation means

  Deprecation removes the image from the Azure Marketplace catalog but doesn't remove OS disks of existing VMs.

  - A deprecated image can't be used for new VM or VMSS instance creation after the enforcement date.
  - Existing VMs and VMSS instances that were created before the enforcement date continue operating normally.
  - VMSS scale-out operations are blocked after the enforcement date because scaling out requires creating new instances from the deprecated image.

  ## Key points

  - **No action required for existing VMs:** Once created, VMs boot from their OS disk—not from the original image. Deprecation doesn't affect running VMs.
  - **Most operations continue working:** Start, stop, restart, deallocate, and redeploy all work normally.
  - **Reimage is blocked:** This is the only VM operation affected because it requires recreating the OS disk from the source image.
  - **VMSS instances continue running:** Existing instances are unaffected, but scale-out is blocked after enforcement.


sections:
  - name: Ignored
    questions:
      - question: What does it mean when I receive an image deprecation notice?
        answer: |
          You receive an email notification when your virtual machine (VM) or virtual machine scale set runs on an image scheduled for deprecation. Publishers deprecate images for various reasons, including security concerns or when images reach end of life.

          :::image type="content" source="media/deprecated-images/mail.png" alt-text="Screenshot of the email notification for virtual machines or scale sets using an image scheduled for deprecation.":::

          **Deprecation levels**
          
          Deprecation occurs at three levels:
          - **Image version deprecation**: A specific VM image version.
          - **Plan/SKU deprecation**: An entire plan or SKU and all image versions within it.
          - **Offer deprecation**: The entire VM offer, including all plans and image versions.

      - question: What is the deprecation timeline and how does it affect my workloads?
        answer: |
          **Notice period (90 days before enforcement)**

          During the notice period:
          - You receive email notifications and Azure Advisor recommendations about the upcoming deprecation.
          - Existing VMs and virtual machine scale set instances continue to run normally.
          - You can deploy new instances by using Azure CLI, PowerShell, or APIs.
          - Deprecation warnings appear in the Azure portal, Azure CLI, and APIs.
          - You can migrate or update your deployments until the enforcement date.

          **After enforcement date (soft delete)**

          After the enforcement date:
          - New VM or virtual machine scale set deployments that use deprecated images are blocked.
          - Existing VMs and virtual machine scale set instances continue to run without disruption.
          - Virtual machine scale set scale-out is blocked because it requires creating new instances from the deprecated image.
          - Most VM operations (start, stop, restart, deallocate, redeploy) continue working. See [Which operations are affected by image deprecation?](#which-operations-are-affected-by-image-deprecation) for details.

          **Required actions**

          To avoid disruption:
          - [Migrate to a supported image](#how-do-i-migrate-to-a-different-image) before the enforcement date if you need your virtual machine scale set to scale out after deprecation.
          - If you configured automatic OS upgrades, only offer or plan deprecation affects you, not individual version deprecation.

      - question: Which operations are affected by image deprecation?
        answer: |
          **VM operations**

          Once a VM is created, Azure creates an OS disk, and the VM boots exclusively from that disk—not from the original image reference. A deprecated or removed image doesn't impact an already-running VM.

          | Operation | Before enforcement | After enforcement | Explanation |
          |-----------|-------------------|-------------------|-------------|
          | **Reimage** | Works | Blocked | Reimage requires Azure to create a new OS disk from the source image. If the image is deprecated or removed, reimage fails. |
          | **Redeploy** | Works | Works | Redeploy moves the VM to new hardware but doesn't recreate the OS disk. |
          | **Start / Restart** | Works | Works | These operations don't require the source image. |
          | **Deallocate / Stop** | Works | Works | These operations don't require the source image. |

          > [!NOTE]
          > The VM's image reference property might disappear from the Azure portal, but this has no effect on VM operation. The OS disk is authoritative for boot.

          **Virtual machine scale set operations**

          Existing virtual machine scale set instances continue running normally even after the base image is deprecated.

          | Operation | Before enforcement | After enforcement |
          |-----------|-------------------|-------------------|
          | Existing instances | Continue running | Continue running |
          | Scale-out | Allowed | Blocked |
          | Reimage | Works | Blocked |

          **Action required:** None for existing workloads. Migrate to a supported image before the enforcement date only if you need your virtual machine scale set to scale out after deprecation.

      - question: How do I find VMs using deprecated images?
        answer: |
          **Option 1: Use Azure Resource Graph**

          Run the following query in [Azure Resource Graph](/azure/governance/resource-graph/overview) to list all VMs and their image details:
          
          ```kusto
          resources 
          | where type == "microsoft.compute/virtualmachines" 
          //| where properties.storageProfile.imageReference.publisher =~ 'MicrosoftWindowsServer' //Optional: Filter by publisher
          //| where properties.storageProfile.imageReference.sku =~ '2016-Datacenter' //Optional: Filter by SKU (Plan)
          //| where properties.storageProfile.imageReference.version == '14393.4467.2106061537' //Optional: Filter by version
          | project name, subscriptionId, resourceGroup, ImagePublisher=properties.storageProfile.imageReference.publisher, ImageOffer=properties.storageProfile.imageReference.offer, imageSku=properties.storageProfile.imageReference.sku, imageVersion=properties.storageProfile.imageReference.exactVersion
          ```

          **Option 2: Use Azure CLI**

          To list all VMs using a specific SKU (replace `2016-Datacenter` with your deprecated SKU):
          
          ```azurecli
          az vm list --query "[?storageProfile.imageReference.sku=='2016-Datacenter'].{VM:id, imageOffer:storageProfile.imageReference.offer, imagePublisher:StorageProfile.imageReference.publisher, imageSku: storageProfile.imageReference.sku, imageVersion:storageProfile.imageReference.version}"
          ```
          
          To list all VMs using a specific image version (replace with your deprecated version):
          
          ```azurecli
          az vm list --query "[?storageProfile.imageReference.version=='14393.4402.2105052108'].{VM:id, imageOffer:storageProfile.imageReference.offer, imagePublisher:StorageProfile.imageReference.publisher, imageSku: storageProfile.imageReference.sku, imageVersion:storageProfile.imageReference.version}"
          ```

          **Option 3: Use PowerShell**

          To list all VMs using a specific SKU (replace `2016-Datacenter` with your deprecated SKU):
          
          ```powershell
          Get-AzVM | Where-Object {$_.StorageProfile.ImageReference.Sku -eq '2016-Datacenter'} | Select-Object -Property ResourceGroupName, Name, @{label='imageOffer'; expression={$_.StorageProfile.ImageReference.Offer}}, @{label='imagePublisher'; expression={$_.StorageProfile.ImageReference.Publisher}}, @{label='imageSKU'; expression={$_.StorageProfile.ImageReference.Sku}}, @{label='imageVersion'; expression={$_.StorageProfile.ImageReference.ExactVersion}}
          ```
          
          To list all VMs using a specific image version (replace with your deprecated version):
          
          ```powershell
          Get-AzVM | Where-Object {$_.StorageProfile.ImageReference.ExactVersion -eq '14393.4402.2105052108'} | Select-Object -Property ResourceGroupName, Name, @{label='imageOffer'; expression={$_.StorageProfile.ImageReference.Offer}}, @{label='imagePublisher'; expression={$_.StorageProfile.ImageReference.Publisher}}, @{label='imageSKU'; expression={$_.StorageProfile.ImageReference.Sku}}, @{label='imageVersion'; expression={$_.StorageProfile.ImageReference.ExactVersion}}
          ```

          **Option 4: Use automated script**
          
          Run [Get-AzVMImageDeprecationStatus.ps1](https://github.com/Azure/azure-support-scripts/tree/master/VMImages#readme) to list all VMs in a subscription that were created from deprecated or soon-to-be-deprecated images.

      - question: How do I find virtual machine scale sets using deprecated images?
        answer: |
          **Option 1: Use Azure Resource Graph**

          Run the following query in [Azure Resource Graph](/azure/governance/resource-graph/overview) to list all virtual machine scale sets and their image details:
          
          ```kusto
          resources 
          | where type == "microsoft.compute/virtualmachinescalesets" 
          //| where properties.virtualMachineProfile.storageProfile.imageReference.publisher =~ 'MicrosoftWindowsServer' //Optional: Filter by publisher
          //| where properties.virtualMachineProfile.storageProfile.imageReference.sku =~ '2016-Datacenter' //Optional: Filter by SKU (Plan)
          //| where properties.virtualMachineProfile.storageProfile.imageReference.version == '14393.4467.2106061537' //Optional: Filter by version
          //| where properties.virtualMachineProfile.storageProfile.imageReference.version != "latest" //Optional: Exclude scale sets using "latest"
          | project name, subscriptionId, resourceGroup, ImagePublisher=properties.virtualMachineProfile.storageProfile.imageReference.publisher, ImageOffer=properties.virtualMachineProfile.storageProfile.imageReference.offer, imageSku=properties.virtualMachineProfile.storageProfile.imageReference.sku, imageVersion=properties.virtualMachineProfile.storageProfile.imageReference.version
          ```

          **Option 2: Use Azure CLI**

          To list all virtual machine scale sets using a specific SKU (replace `2016-Datacenter` with your deprecated SKU):
          
          ```azurecli
          az vmss list --query "[?virtualMachineProfile.storageProfile.imageReference.sku=='2016-Datacenter'].{VMSS:id, imageOffer:virtualMachineProfile.storageProfile.imageReference.offer, imagePublisher:virtualMachineProfile.storageProfile.imageReference.publisher, imageSku:virtualMachineProfile.storageProfile.imageReference.sku, imageVersion:virtualMachineProfile.storageProfile.imageReference.version}"
          ```
          
          To list all virtual machine scale sets using a specific image version (replace with your deprecated version):
          
          ```azurecli
          az vmss list --query "[?virtualMachineProfile.storageProfile.imageReference.version=='14393.4402.2105052108'].{VMSS:id, imageOffer:virtualMachineProfile.storageProfile.imageReference.offer, imagePublisher:virtualMachineProfile.storageProfile.imageReference.publisher, imageSku:virtualMachineProfile.storageProfile.imageReference.sku, imageVersion:virtualMachineProfile.storageProfile.imageReference.version}"
          ```

          **Option 3: Use PowerShell**

          To find virtual machine scale sets using a specific SKU (replace `2016-Datacenter` with your deprecated SKU):
          
          ```powershell
          $vmsslist = Get-AzVmss
          $vmsslist | Where-Object {$_.virtualMachineProfile.storageProfile.imageReference.Sku -eq '2016-Datacenter'} | Select-Object -Property ResourceGroupName, Name, @{label='imageOffer'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Offer}}, @{label='imagePublisher'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Publisher}}, @{label='imageSKU'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Sku}}, @{label='imageVersion'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Version}}
          ```
          
          To find virtual machine scale sets using a specific image version (replace with your deprecated version):
          
          ```powershell
          $vmsslist = Get-AzVmss
          $vmsslist | Where-Object {$_.virtualMachineProfile.storageProfile.imageReference.Version -eq '14393.4402.2105052108'} | Select-Object -Property ResourceGroupName, Name, @{label='imageOffer'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Offer}}, @{label='imagePublisher'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Publisher}}, @{label='imageSKU'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Sku}}, @{label='imageVersion'; expression={$_.virtualMachineProfile.storageProfile.imageReference.Version}}
          ```

          **Option 4: Use automated script**
          
          Run [Get-AzVMImageDeprecationStatus.ps1](https://github.com/Azure/azure-support-scripts/tree/master/VMImages#readme) to list all virtual machine scale sets in a subscription that were created from deprecated or soon-to-be-deprecated images.

      - question: When should I migrate my VMs or virtual machine scale sets to a different image?
        answer: |
          Migration isn't always required. Consider the following scenarios to determine whether you need to take action:

          **Migration required**

          - **Virtual machine scale sets that need to scale out:** Scale-out operations are blocked after the enforcement date because they require creating new instances from the deprecated image. Migrate before enforcement if you need scale-out capability.
          - **Workloads that require reimage operations:** Reimage recreates the OS disk from the source image, which fails after the image is deprecated.
          - **Disaster recovery scenarios:** Azure Site Recovery and backup restore operations that rely on the deprecated image won't work after enforcement.
          - **Paid Marketplace images:** After deprecation, you can't create new workloads or perform restore operations because of missing purchase plan information. Migrate to a supported image.

          **Migration not required**

          - **Running VMs that don't need reimage:** Once created, VMs boot from their OS disk—not from the original image. Deprecation doesn't affect already-running VMs.
          - **Virtual machine scale sets that don't scale out:** Existing instances continue running normally.
          - **Routine operations:** Start, stop, restart, deallocate, and redeploy all continue to work after enforcement.
          - **Virtual machine scale sets using automatic OS upgrades:** If you configured automatic OS upgrades and only the image version is deprecated (not the entire offer or plan), you don't need to take action.

          **Recommended actions**

          - Review which VMs and virtual machine scale sets use the deprecated image. See [How do I find VMs using deprecated images?](#how-do-i-find-vms-using-deprecated-images) and [How do I find virtual machine scale sets using deprecated images?](#how-do-i-find-virtual-machine-scale-sets-using-deprecated-images).
          - Evaluate whether your workloads require any blocked operations after enforcement.
          - If migration is required, plan and test before the enforcement date.

      - question: How do I migrate a VM to a different image?
        answer: |
          Azure VMs don't support in-place OS upgrades. Create a new VM using a supported image, migrate your data, and decommission the old VM.

          > [!IMPORTANT]
          > For deprecated paid Marketplace images: After deprecation, you can't create new VMs or perform backup restore operations because of missing plan information. Migrate before the enforcement date.

          ## Part 1: Create a new VM

          1. **Identify the replacement image**: Check your deprecation email for the recommended replacement. For more information, see [Find and use images using the Azure CLI](./linux/cli-ps-findimage.md) or  [Find and use images using Azure PowerShell](./windows/cli-ps-findimage.md).

          1. **Configure the new VM**: For the simplest migration, match the region and networking settings of your existing VM. You can change VM size or region if needed.

          1. **Deploy and test**: Confirm the VM starts correctly and your application dependencies are present.

          ## Part 2: Migrate data

          **Method A: Disk snapshot (fastest for lift-and-shift)**

          1. [Create a snapshot](snapshot-copy-managed-disk.md) of the old VM's data disks.
          1. [Create managed disks from the snapshots](snapshot-copy-managed-disk.md#create-a-disk-from-a-snapshot).
          1. [Attach the disks to the new VM](attach-managed-disk-portal.md) and mount them.
          1. Copy data to the new VM, then detach the old disks.

          **Method B: File-based transfer (safer for partial moves)**

          Use OS transfer tools:
          - **Windows**: Robocopy or SMB share
          - **Linux**: rsync, scp, or sftp
          - **Cross-OS**: [Use AzCopy](/azure/storage/common/storage-use-azcopy-v10) with an Azure Storage account as intermediate share

          ## Part 3: Switch over

          1. **Validate**: Verify network connectivity, application functionality, firewall rules, and extensions.
          1. **Update references**: Point DNS names, load balancers, or API endpoints to the new VM.
          1. **Decommission**: Keep the old VM briefly for rollback, then deallocate and delete it.

      - question: How do I migrate a virtual machine scale set to a different image?
        answer: |
          The migration approach depends on whether an image version, plan/SKU, or entire offer is deprecated.

          ## Version deprecation

          If only a specific image version is deprecated:

          - **Using "latest" version**: No action required for new instances. Azure resolves to the newest available version at deployment time. However, existing instances remain on their original version.
          - **Using automatic OS upgrades**: No action required. Azure upgrades existing instances to the latest version automatically, regardless of whether your image reference uses "latest" or a pinned version.
          - **Using a pinned version without automatic OS upgrades**: Update the image reference to a supported version. See [Modify an Azure virtual machine scale set](../virtual-machine-scale-sets/virtual-machine-scale-sets-upgrade-scale-set.md). After updating the model, upgrade existing instances using one of these methods:
            - **Manual upgrade**: Use `az vmss update-instances` (CLI) or `Update-AzVmssInstance` (PowerShell) to upgrade specific instances.
            - **Rolling upgrade policy**: Configure the upgrade policy to "Rolling" so instances automatically upgrade when the model changes.

          > [!TIP]
          > Enable [automatic OS image upgrade](../virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-upgrade.md) to avoid manual intervention for future version deprecations.

          ## Plan/SKU deprecation

          If an entire plan or SKU is deprecated, update to a different SKU from the same offer using a scale-out/scale-in approach:

          1. Find an alternative SKU from your deprecation email or by using [Find and use Azure Marketplace VM images](cli-ps-findimage.md).

          1. Update the VMSS model to use the new SKU:

             ```azurecli
             az vmss update --resource-group <resource-group> --name <vmss-name> \
               --set virtualMachineProfile.storageProfile.imageReference.sku=<new-sku> \
               --set virtualMachineProfile.storageProfile.imageReference.version=latest
             ```

          1. Scale out to create new instances using the updated image, then scale in to remove old instances. Or delete specific old instances and let the scale set replace them with new ones.

          > [!IMPORTANT]
          > Upgrading or reimaging existing instances replaces their OS disks. Use scale-out/scale-in to avoid data loss on OS disks.

          ## Offer deprecation

          If an entire offer is deprecated, create a new virtual machine scale set with a supported image:

          1. Find a replacement offer from your deprecation email or search in the [Azure Marketplace](https://azuremarketplace.microsoft.com/).

          1. Create a new virtual machine scale set using the replacement image. Match your existing configuration (networking, extensions, scaling rules).

          1. Test application compatibility thoroughly. A different publisher or offer may have significant OS or configuration differences.

          1. Migrate traffic to the new scale set, then delete the old one.

          > [!NOTE]
          > Creating a new VMSS is recommended over in-place updates when changing publishers or offers, because the differences between images are typically significant.

      - question: How do I receive email notifications about image deprecation?
        answer: |
          Azure notifies you about image deprecation through two channels:

          - **Email notifications**: Sent directly to subscription administrators with the **Owner** or **Account Admin** role on the subscription.
          - **Azure Advisor recommendations**: Deprecation recommendations appear in [Azure Advisor](/azure/advisor/advisor-overview).

          **Notify additional recipients**

          To notify team members who don't have Owner or Account Admin roles on the subscription, [create an Advisor alert](/azure/advisor/advisor-alerts-portal) with an action group. Action groups let you specify email addresses, SMS numbers, or webhooks to receive notifications when new deprecation recommendations are published.
           
      - question: How do I check if a specific image is deprecated or scheduled for deprecation?
        answer: |
          **Option 1: Use Azure CLI**
          
          ```azurecli
          az vm image show --location eastus --urn MicrosoftWindowsServer:WindowsServer:2016-Datacenter:14393.4169.2101090332 --query [imageDeprecationStatus]
          ```
          
          **Option 2: Use PowerShell**

          To check a single image version:
          
          ```powershell
          Get-AzVMImage -Location "eastus" -PublisherName "MicrosoftWindowsServer" -Offer "WindowsServer" -Skus "2016-Datacenter" -Version "14393.4169.2101090332" | Select-Object -ExpandProperty "ImageDeprecationStatus"
          ```

          To check all versions of a SKU with deprecation details:

          ```powershell
          Get-AzVMImage -Location "westus" `
            -PublisherName "center-for-internet-security-inc" `
            -Offer "cis-rocky" `
            -Skus "cis-rockylinux-9-l1-gen2-azure-observability" `
            -Expand "properties/imageDeprecationStatus" |
            Select-Object Version, @{
              Name = "DeprecationDetails"
              Expression = { $_.ImageDeprecationStatus | Out-String }
            } | Format-Table -Wrap -AutoSize
          ```

          **Option 3: Use REST API**
          
          Use the [Virtual Machine Images - Get](/rest/api/compute/virtual-machine-images/get?tabs=HTTP) API. If the image is deprecated, you receive a response like:
          
          ```json
          {
            "error": {
              "code": "ImageVersionDeprecated",
              "message": "VM Image from publisher: MicrosoftWindowsServer with - Offer: WindowsServer, Sku: 2016-Datacenter, Version: 14393.4169.2101090332 is deprecated."
            }
          }
          ```

          **Option 4: Use automated script**
          
          Run [Get-AzVMImageDeprecationStatus.ps1](https://github.com/Azure/azure-support-scripts/blob/master/VMImages/README.md) in Cloud Shell or locally to check all VMs and virtual machine scale sets in a subscription for deprecated images.

      - question: How do I list active (non-deprecated) image versions for a specific SKU?
        answer: |
          Active images are images that aren't scheduled for deprecation or already deprecated.

          **Option 1: Use Azure CLI**
          
          ```azurecli
          az vm image list --location eastus --publisher "MicrosoftWindowsServer" --offer "WindowsServer" --sku "2022-Datacenter" --all --query "[?imageDeprecationStatus.imageState=='Active']"
          ```

          **Option 2: Use PowerShell**

          ```powershell
          Get-AzVMImage -Location "westus" `
            -PublisherName "center-for-internet-security-inc" `
            -Offer "cis-rocky" `
            -Skus "cis-rockylinux-9-l1-gen2-azure-observability" `
            -Expand "properties/imageDeprecationStatus" |
            Where-Object { $_.ImageDeprecationStatus.ImageState -eq "Active" } |
            Select-Object Version
          ```

      - question: What happens to SQL Server if a SQL Server Azure Marketplace image is deprecated?
        answer: |
          Your SQL Server remains unaffected when a SQL Server Azure Marketplace image is deprecated:

          - Your Azure VM continues to run without interruption.
          - Your SQL Server instance continues to function normally.
          - You can't deploy new VMs using the deprecated SQL Server image.

          Existing deployments require no action.
